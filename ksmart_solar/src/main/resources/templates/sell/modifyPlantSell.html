<!DOCTYPE html>
<html xmlns:th="http://www.tyhmeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="layout/default">
	<th:block layout:fragment="customCss">
		<!-- Bootstrap core CSS -->
	  <link th:href="@{/lib/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
	  <!--external css-->
	  <link href="@{/lib/font-awesome/css/font-awesome.css}" rel="stylesheet" />
	  <link rel="stylesheet" type="text/css" th:href="@{/lib/bootstrap-fileupload/bootstrap-fileupload.css}" />
	  <link rel="stylesheet" type="text/css" th:href="@{/lib/bootstrap-datepicker/css/datepicker.css}" />
	  <link rel="stylesheet" type="text/css" th:href="@{/lib/bootstrap-daterangepicker/daterangepicker.css}" />
	  <link rel="stylesheet" type="text/css" th:href="@{/lib/bootstrap-timepicker/compiled/timepicker.css}" />
	  <link rel="stylesheet" type="text/css" th:href="@{/lib/bootstrap-datetimepicker/datertimepicker.css}" />
	  <!-- Custom styles for this template -->
	  <link th:href="@{/css/style.css}" rel="stylesheet">
	  <link th:href="@{/css/style-responsive.css}" rel="stylesheet">
	</th:block>
	<th:block layout:fragment="customTitle">
				<title>발전소 공고 수정</title>
	</th:block>
	<th:block layout:fragment="Contents">
	
	<div id="container-header-title"><strong>공고수정</strong></div>
     	<div id="container-header-path">판매관리 > 공고수정</div>
      	<div id="container-header-space"></div>
      	
		<div class="row mt">
          <div class="col-lg-12">
            <div class="form-panel">
              <div class="form">
                <form class="cmxform form-horizontal style-form" id="plantSellFormM" method="post" th:action="@{/sell/modifyPlantSell}" enctype="multipart/form-data">
					<th:block th:each="bidPlant : ${bidPlant}">
						<input type="hidden" name="mId" th:value="${session.SID}">
						<input type="hidden" name="bPlCode" th:value="${bidPlant.bPlCode}">
						<div class="form-group">
		                    <label for="bzPlNameM" class="control-label col-lg-2">발전소</label>
		                    <div class="col-lg-10">
		                     	<input class=" form-control" id = "bzPlNameM" name="bzPlName" type="text" th:value="${bidPlant.businessPlantDTO.bzPlName}" readonly>
		                    </div>
						</div>
		                  <div class="form-group">
		                    <label for="bPlTitle" class="control-label col-lg-2">제목</label>
		                    <div class="col-lg-10">
		                      <input class=" form-control" id="bPlTitleM" th:value="${bidPlant.bPlTitle}" name="bPlTitle" type="text">
		                    </div>
		                  </div>
		                  <div class="form-group ">
		                    <label for="plDepDataResidual" class="control-label col-lg-2">잔존가치</label>
		                    <div class="col-lg-10">
		                      <input class=" form-control" id="plDepDataResidualM" th:value="${bidPlant.plDepDataResidual}" name="plDepDataResidual" type="text" readonly>
		                    </div>
		                  </div>
		                  <div class="form-group">
		                    <label for="bPlPrice" class="control-label col-lg-2">입찰시작가</label>
		                    <div class="col-lg-10">
		                      <input class=" form-control" id="bPlPriceM" th:value="${bidPlant.bPlPrice}" name="bPlPrice" type="text">
		                    </div>
		                  </div>
		                 <div class="form-group">
		                 	<label for="filesM" class="control-label col-lg-2">공고신청파일</label>
		                  	<div class="col-lg-10">
		                    	<input type="file" id="filesM" class="default" name="files" multiple="multiple">
		                  	</div>
		                </div>
		                  <div class="form-group ">
		                    <label for="bPlContentsM" class="control-label col-lg-2">상세설명</label>
		                    <div class="col-lg-10">
		                      <textarea id = "bPlContentsM" class="form-control" name="bPlContents">[[${bidPlant.bPlContents}]]</textarea>
		                    </div>
		                  </div>
		                 <div class="form-group">
		                  <label for ="bPlDateBidding1M" class="control-label col-lg-2">공고시작일</label>
		                  <div class="col-lg-10">
		                    <input id="bPlDateBidding1M" class="form-control form-control-inline input-medium default-date-picker" size="16" type="text" name="bPlDateBidding1" th:value="${bidPlant.bPlDateBidding1}">
		                  </div>
		                </div>                  
		                  <div class="form-group">
		                    <div class="col-lg-offset-2 col-lg-10">
		                      <button class="btn btn-theme" type="button" id="btnPlantSellM">신청</button>
		                      
		                      <button class="btn btn-theme04" type="button" id="cancelBtnPlantSellM">취소</button>
		                    </div>
		                  </div>
					</th:block>
                </form>
              </div>
            </div>
          </div>
        </div>
        
        
	</th:block>
	<th:block layout:fragment="customScript">
		<script type="text/javascript">
			var sell = $('#sell');
			sell.addClass('active');
			sell.parent().find('.sub').css('display','block');
			sell.parent().find('.sub').children().eq(0).addClass('active');
		</script>
		
		<script type="text/javascript">
	 	
  			var bPlPrice = document.getElementById('bPlPriceM');
  			var plDepDataResidual = document.getElementById('plDepDataResidualM');
  			bPlPrice.onkeyup = function(){
			//정규표현식 숫자만 입력하게,
            this.value = this.value.replace(/[^0-9]/g,'');
            //1000단위 콤마
			this.value = this.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
			}
  			
 		</script>
 		

		<script th:src="@{/lib/jquery-ui-1.9.2.custom.min.js}"></script>
	  	<script type="text/javascript" th:src="@{/lib/bootstrap-datepicker/js/bootstrap-datepicker.js}"></script>
	 	<script th:src="@{/lib/advanced-form-components.js}"></script>

	 	<script>
	 	//발전소 잔존 가치에 콤마 찍는 함수
	 	 function comma(str) {
       		 str = String(str);
       		 return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
  		  }
	 	//콤마 없애는 함수
	 	function rm_comma(num){
	 	   var number = num + "";
	 	   return number.replace(/,/g,"");
	 	}

	 	
	 	$(document).ready(function(){
	 		console.log('실행이 되어야 하는데...')
	 		$('#plDepDataResidualM').val(comma($('#plDepDataResidualM').val()));
	 		$('#bPlPriceM').val(comma($('#bPlPriceM').val()));
	 	})	 		
	 	

	 	 $('#btnPlantSellM').click(function(){
	 	
	 		 
	 		 	//유효성검사
			 	if($('select option:selected').val()==0){
					alert('발전소를 선택해주세요.');
					return;
				}if($('#bPlTitleM').val()==''){
					alert('공고 제목을 입력해주세요.')
					$('#bPlTitleM').focus();
					return;
				}if($('#bPlPriceM').val()==''){
					alert('희망 가격을 입력해주세요.')
					$('#bPlPrice').focus();
					return;
				}if($('#filesM').val()==''){
					alert('파일을 첨부해주세요.');
					return;
				}if($('#bPlContentsM').val().length==0){
					alert('상세정보를 입력해주세요.');
					return;
				}if($('#bPlDateBidding1M').val()==''){
					alert('희망 공고 시작 날짜를 입력해주세요.');
					return;
				}
				
				
				$('#bPlPriceM').val(rm_comma($('#bPlPriceM').val()));
				$('#plDepDataResidualM').val(rm_comma($('#plDepDataResidualM').val()));
			
	
				$('#plantSellFormM').submit();
				
	 	 })
	 	 
	 	 
	 	 $('#cancelBtnPlantSellM').click(function(){
	 		 console.log('취소버튼');
	 		$('#bPlTitleM').val('');
	 		$('#bPlPriceM').val('');
	 		$('#filesM').val('');
	 		$('#bPlContentsM').val('');
	 		$('#bPlDateBidding1M').val('');
	 		
	 	 })
	 	 
	 
	 	 
	 	</script>

		
	</th:block>
</body>

</html>
					
