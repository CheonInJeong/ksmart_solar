<!DOCTYPE html>
<html xmlns:th="http://www.tyhmeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="layout/default">

	<th:block layout:fragment="customTitle">
				<title>테스트</title>
	</th:block>
	<th:block layout:fragment="Contents">
		<div id="container-header-title"><strong>입찰자목록</strong></div>
     	<div id="container-header-path">정책관리 > <a th:href="@{/sell/myHistory}">내공고목록</a> >입찰자목록</div>
      	<div id="container-header-space"></div>		
		
		<div class="row mt">
          <div class="col-md-12">
            <div class="content-panel" style="padding:30px;">
              <h4><i class="fa fa-angle-right"></i>발전소 입찰자 목록</h4>
            	 <th:block th:each="p:${plant}">
					<p>　　발전소 :  [[${p.businessPlantDTO.bzPlName}]]</p>
	               	<p>　　공고제목 : [[${p.bPlTitle}]] </p>
	               	<span style="float:right;"> ※ 낙찰자 결정기간(<span style="color:blue;">~[[${p.bPlDateDecision2}]]</span>)까지 결정된 높은 순위로 낙찰자우선자가 결정됩니다.</span>
	               	<span style="display : none" id="bPlCode">[[${p.bPlCode}]]</span>
        		 </th:block> 
              <hr>
              <table class="table table-striped table-advance table-hover">
               
                <thead>
                  <tr>
                  	<th>입찰자코드</th>
                   
                    <th><i class="fa fa-bookmark"></i>입찰자</th>
                    <th>희망가격</th>
                    <th><i class=" fa fa-edit"></i>서류적합</th>
                    <th>순위</th>
                    <th>상세보기</th>
                  </tr>
                </thead>
                <tbody>
                  <tr th:if="${#lists.size(bidder)}>0" th:each="b:${bidder}">
                  	<td th:text="${b.bCode}" class="bCode"></td>
                  	<td th:text="${b.mId}"></td>
                  	<td th:text="${b.bPrice}" class="bidPrice"></td>
                  	<td th:text=${b.bCheck}></td>
                  	<td th:text=${b.bRank}></td>
                  	<td><a class="btn btn-default detailBtn">상세보기</a></td>
                  </tr>
                  <tr th:unless="${#lists.size(bidder)}>0">
                  	<td colspan="8" style="text-align:center;">아직 입찰자가 없습니다.</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
         <div class="add-task-row" style="margin-top: 20px;">
			<a th:href="@{/sell/myHistory}" class="btn btn-default btn-sm pull-right">목록</a>
		</div>
  
        
	</th:block>
	<th:block layout:fragment="customScript">
		<script type="text/javascript">
			var sell = $('#sell');
			sell.addClass('active');
			sell.parent().find('.sub').css('display','block');
			sell.parent().find('.sub').children().eq(1).addClass('active');
		</script>
			
		<script>
				function comma(str) {
       			 str = String(str);
       		 	return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
  		  	}

			$(document).ready(function(){
				$('.bidPrice').each(function(){
					
					var bidPrice = $('.bidPrice');
					var i = bidPrice.index(this);
					console.log(i);
					console.log(bidPrice.eq(i).text());
					bidPrice.eq(i).text(comma(bidPrice.eq(i).text()));
				})
		
			})
			
			$('.detailBtn').click(function(){
				var i = $('.detailBtn').index(this);
				location.href='/sell/bidderDetail?bCode='+$('.bCode').eq(i).text()+'&bPlCode='+$('#bPlCode').text();
			})
			
		</script>
	</th:block>
</html>