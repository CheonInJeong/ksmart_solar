<!DOCTYPE html>
<html xmlns:th="http://www.tyhmeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="@{layout/default}">
	<th:block layout:fragment="customCss">
	  <link rel="stylesheet" type="text/css" th:href="@{/lib/bootstrap-datepicker/css/datepicker.css}" />
	</th:block>
	<th:block layout:fragment="customTitle">
				<title>부품 판매 공고 신청</title>
	</th:block>
	<th:block layout:fragment="Contents">
	
	<div id="container-header-title"><strong>재공고신청</strong></div>
     	<div id="container-header-path">판매관리 > 재공고신청</div>
      	<div id="container-header-space"></div>
      	
		<div class="row mt">
          <div class="col-lg-12">
            <div class="form-panel">
              <div class="form">
              
              <div>
                <form class="cmxform form-horizontal style-form" id="plantSellForm" method="post" th:action="@{/sell/addNewPlantSell}" enctype="multipart/form-data">
                	<input type="hidden" name="bPlGroupcode" th:value="${plant.bPlGroupcode}">
                	<input type="hidden" name="bzPlCode" th:value="${plant.bzPlCode}">
                	<input type="hidden" name="mId" th:value="${session.SID}">
                	<input type="hidden" name="plDepPrice" th:value="${plant.plDepPrice}">
                	<input type="hidden" name="plDepStartDate" th:value="${plant.plDepStartDate}">
	                  <div class="form-group">
	                    <label for="username" class="control-label col-lg-2">발전소</label>
	                    <div class="col-lg-10">
	                      <input class=" form-control" id="bzPlName" type="text" th:value="${plant.businessPlantDTO.bzPlName}" readonly>
	                    </div>
	                  </div>
	                  
	                  <div class="form-group">
	                    <label for="bPlTitle" class="control-label col-lg-2">제목</label>
	                    <div class="col-lg-10">
	                      <input class=" form-control" id="bPlTitle" name="bPlTitle" type="text" th:value="${plant.bPlTitle}">
	                    </div>
	                  </div>
	                  <div class="form-group ">
	                    <label for="plDepDataResidual" class="control-label col-lg-2">잔존가치</label>
	                    <div class="col-lg-10">
	                      <input class=" form-control" id="plDepDataResidual" name="plDepDataResidual" type="text" th:value="${residual}" readonly>
	                    </div>
	                  </div>
	                  <div class="form-group ">
	                    <label for="b_cp_price" class="control-label col-lg-2">
	                   		<span style="display:block">입찰시작가</span>
	                    	<span id="originalPrice">이전가 : [[${plant.bPlPrice}]] </span>
	                    </label>
	                    <div class="col-lg-10">
	                      <input class=" form-control" id="bPlPrice" name="bPlPrice" type="text">
	                    </div>
	                  </div>
	                 <div class="form-group">
	                 	<label for="files" class="control-label col-lg-2">공고신청서</label>
	                  	<div class="col-lg-10">
	                    	<input type="file" id="files" class="default" name="files" multiple="multiple">
	                  	</div>
	                </div>
	         
	                  <div class="form-group ">
	                    <label for="bPlContents" class="control-label col-lg-2">상세설명</label>
	                    <div class="col-lg-10">
	                      <textarea id = "bPlContents"class="form-control" name="bPlContents" th:text="${plant.bPlContents}"></textarea>
	                    </div>
	                  </div>
	                 <div class="form-group">
	                  <label for ="bPlDateBidding1" class="control-label col-lg-2">공고시작일</label>
	                  <div class="col-lg-10">
	                    <input class="form-control form-control-inline input-medium default-date-picker" size="16" type="text" name="bPlDateBidding1" id="bPlDateBidding1">
	                  </div>
	                </div>                  
	                  <div class="form-group">
	                    <div class="col-lg-offset-2 col-lg-10">
	                      <button class="btn btn-theme" type="button" id="btnPlantSell">신청</button>
	                      
	                      <button class="btn btn-theme04" type="button" id="cancelBtnPlantSell">취소</button>
	                    </div>
	                  </div>
                </form>
                
               </div> 
              </div>
            </div>
          </div>
        </div>
        
	</th:block>
	<th:block layout:fragment="customScript">
		<script type="text/javascript">
			var sell = $('#sell');
			sell.addClass('active');
			sell.parent().find('.sub').css('display','block');
			sell.parent().find('.sub').children().eq(0).addClass('active');
		</script>
		
		<script th:src="@{/lib/jquery-ui-1.9.2.custom.min.js}"></script>
	  	<script type="text/javascript" th:src="@{/lib/bootstrap-datepicker/js/bootstrap-datepicker.js}">
	  	 $('.default-date-picker').datepicker({ dateFormat: 'yy-mm-dd', minDate: 7 });
	  	</script>
	 	<script th:src="@{/lib/advanced-form-components.js}"></script>
		
		<script type="text/javascript">
			//발전소 잔존 가치에 콤마 찍는 함수
		 	 function comma(str) {
	      		 str = String(str);
	      		 return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
	 		  }
		 	//콤마 없애는 함수
		 	function rm_comma(num){
		 	   var number = num + "";
		 	   return number.replace(/,/g,"");
		 	}
			
		
	 		$(document).ready(function(){
	 			var bPlPrice = document.getElementById('bPlPrice');
	  			bPlPrice.onkeyup = function(){
				//정규표현식 숫자만 입력하게,
	            this.value = this.value.replace(/[^0-9]/g,'');
	            //1000단위 콤마
				this.value = this.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
				}
	  			
	  			$('#plDepDataResidual').val(comma($('#plDepDataResidual').val()))
	  			$('#originalPrice').text(comma($('#originalPrice').text()))
	  			
	 		})
  			
 	



	 	 
	 	 $('#btnPlantSell').click(function(){
	 	
	 		 
	 		 	//유효성검사
			 	if($('select option:selected').val()==0){
					alert('발전소를 선택해주세요.');
					return;
				}if($('#bPlTitle').val()==''){
					alert('공고 제목을 입력해주세요.')
					$('#bPlTitle').focus();
					return;
				}if($('#bPlPrice').val()==''){
					alert('희망 가격을 입력해주세요.')
					$('#bPlPrice').focus();
					return;
				}if($('#files').val()==''){
					alert('파일을 첨부해주세요.');
					return;
				}if($('#bPlContents').val().length==0){
					alert('상세정보를 입력해주세요.');
					return;
				}if($('#bPlDateBidding1').val()==''){
					alert('희망 공고 시작 날짜를 입력해주세요.');
					return;
				}
				
				
				$('#bPlPrice').val(rm_comma($('#bPlPrice').val()));
				$('#plDepDataResidual').val(rm_comma($('#plDepDataResidual').val()));
			
	
				$('#plantSellForm').submit();
				
	 	 })
	 	 
	 	 
	 	 $('#cancelBtnPlantSell').click(function(){
	 		 console.log('취소버튼');
	 		$('#bPlTitle').val('');
	 		$('#bPlPrice').val('');
	 		$('#files').val('');
	 		$('#componentDetail').val('');
	 		$('#bPlDateBidding1').val('');
	 		
	 	 })
	 	 
	 	</script>

		
	</th:block>
</body>

</html>
					
