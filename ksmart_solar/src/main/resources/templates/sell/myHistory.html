<!DOCTYPE html>
<html xmlns:th="http://www.tyhmeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="@{layout/default}">

	<th:block layout:fragment="customTitle">
				<title>테스트</title>
	</th:block>
	<th:block layout:fragment="Contents">
		<div class="row mt">
          <div class="col-md-12">
            <div class="content-panel">
              <h4><i class="fa fa-angle-right"></i>내발전소공고목록</h4>
        			  <p>※해당 공고의 입찰자 수를 클릭하면 입찰자 목록을 확인 할 수 있습니다.</p>      
              <hr>
              <form>
            	<select>
            		<option>공고코드</option>
            		<option>발전소명</option>
            		<option>공고시작일</option>
            		<option>진행상황</option>
            	</select>
            	<input type="text" placeholder="검색어">
            	<input type="submit" value = "검색">
               </form>
              <table class="table table-striped table-advance table-hover">
                <thead>
                  <tr>
                  	<th>공고코드</th>
                    <th><i class="fa fa-bullhorn"></i>발전소명</th>
                    <th class="hidden-phone"><i class="fa fa-question-circle"></i>공고명</th>
                    <th><i class="fa fa-bookmark"></i>희망가격</th>
                    <th><i class=" fa fa-edit"></i>공고시작일</th>
                    <th><i class=" fa fa-edit"></i>공고마감일</th>
                    <th><i class="fa fa-edit"></i>입찰자수</th>
                    <th><i class=" fa fa-edit"></i>진행상황</th>
                    <th><i class=" fa fa-edit"></i>수정</th>
                    <th><i class=" fa fa-edit"></i>삭제</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  <tr th:each="list:${bidPlantList}">
                  	<td id="historyBPlCode" th:text=${list.bPlCode}></td>
       				<td th:text="${list.businessPlantDTO.bzPlName}"></td>
                    <td><a th:href="@{/sell/getBidPlantDetail(bPlCode=${list.bPlCode})}">[[${list.bPlTitle}]]</a></td>
                    <td th:text="${list.bPlPrice}"></td>
                    <td th:text="${list.bPlDateBidding1}"></td>
                    <td th:text="${list.bPlDateBidding2}"></td>
                    <td><a th:href="@{/sell/bidderList(bPlCode=${list.bPlCode})}">[[${list.bPlNumberOfBidder}]]</a></td>
                    <td id="historyStatus" th:text="${list.bPlStatus}"></td>
                    <td><button class="HistoryModifyBtn">수정</button></td>
                    <td><button class="HisotryDeleteBtn">삭제</button></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <div class="row mt">
          <div class="col-md-12">
            <div class="content-panel">
              <h4><i class="fa fa-angle-right"></i>내부품공고목록</h4>
              <hr>
              <form>
            	<select>
            		<option>공고코드</option>
            		<option>발전소명</option>
            		<option>공고시작일</option>
            		<option>진행상황</option>
            	</select>
            	<input type="text" placeholder="검색어">
            	<input type="submit" value="검색">
               </form>
              
              <table class="table table-striped table-advance table-hover">
                <thead>
                  <tr>
                  	<th>공고코드</th>
                    <th><i class="fa fa-bullhorn"></i>발전소명</th>
                    <th class="hidden-phone"><i class="fa fa-question-circle"></i>공고명</th>
                    <th><i class="fa fa-bookmark"></i>희망가격</th>
                    <th><i class=" fa fa-edit"></i>공고시작일</th>
                    <th><i class=" fa fa-edit"></i>공고마감일</th>
                    <th><i class="fa fa-edit"></i>입찰자수</th>
                    <th><i class=" fa fa-edit"></i>진행상황</th>
                    <th><i class=" fa fa-edit"></i>수정</th>
                    <th><i class=" fa fa-edit"></i>삭제</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  <tr th:each="list:${bidPlantList}">
                  	<td id="historyBPlCode" th:text=${list.bPlCode}></td>
          <!--          <td th:text="${list.businessPlantDTO.bzPlName}"></td>-->
                    <td><a th:href="@{/sell/getBidPlantDetail(bPlCode=${list.bPlCode})}">[[${list.bPlTitle}]]</a></td>
                    <td th:text="${list.bPlPrice}"></td>
                    <td th:text="${list.bPlDateBidding1}"></td>
                    <td th:text="${list.bPlDateBidding2}"></td>
                    <td th:text="${list.bPlNumberOfBidder}"></td>
                    <td id="historyStatus" th:text="${list.bPlStatus}"></td>
                    <td><button class="HistoryModifyBtn">수정</button></td>
                    <td><button class="HisotryDeleteBtn">삭제</button></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
	</th:block>
	<th:block layout:fragment="customScript">
		<script type="text/javascript">
			var sell = $('#sell');
			sell.addClass('active');
			sell.parent().find('.sub').css('display','block');
			sell.parent().find('.sub').children().eq(1).addClass('active');
		</script>
			
		<script>
			$('.HistoryModifyBtn').click(function(){
				console.log($('.HistoryModifyBtn').index(this));
				var i = $('.HistoryModifyBtn').index(this);
				var status = $('.HistoryModifyBtn').eq(i).parent().parent().children('#historyStatus').text();
				if(status !='공고신청'){
					alert('현재는 공고를 수정 할 수 없습니다.');
					return;
				}
				console.log($('#historyBPlCode').text())
				var path = '/sell/modifyPlantSell?bPlCode='+$('#historyBPlCode').text();
				
				location.href= path;
			})
			
			$('.HisotryDeleteBtn').click(function(){
				console.log($('.HisotryDeleteBtn').index(this));
				var i = $('.HisotryDeleteBtn').index(this);
				var status = $('.HisotryDeleteBtn').eq(i).parent().parent().children('#historyStatus').text();
				if(status !='공고신청'){
					alert('현재는 공고를 삭제 할 수 없습니다.');
					return;
				}
				location.href='/sell/removePlantSell?bPlCode='+$('#historyBPlCode').text();
			})
			
		</script>
	</th:block>
</html>