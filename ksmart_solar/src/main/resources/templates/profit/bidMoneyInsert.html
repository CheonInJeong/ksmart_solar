<!DOCTYPE html>
<html xmlns:th="http://www.tyhmeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head th:replace="fragments/head :: headFragment"></head>
	<th:block layout:fragment="customTitle">
		<title>입출금 입력</title>
	</th:block>
<body>
	<form class="form-horizontal style-form">
		<div class="col-lg-12">
			<div class="form-panel">
				<h4 class="mb"><i class="fa fa-angle-right"></i>입출금 입력</h4>
                <div class="form-group">
                  <label class="col-sm-2 col-sm-2 control-label">거래회원</label>
                  <div class="col-lg-10">
					<select name="mId" class="form-control">
					  <option value="">::: 거래회원 :::</option>
					  <th:block th:each="l : ${memberList}">
						  <option th:value="${l.mId}">[[${l.mId}]]</option>
					  </th:block>
					</select>
				  </div>
				 </div>
				 <div class="form-group">
                  <label class="col-sm-2 col-sm-2 control-label">입출금 구분</label>
                  <div class="col-lg-10">
                  	<select name="bMoType" class="form-control">
					  <option value="">::: 입출금 구분 :::</option>
					  <option value="입금">입금</option>
					  <option value="출금">출금</option>
					</select>
                  </div>
                 </div>
				 <div class="form-group" style="display: none;" id="bMoDetail1">
                  <label class="col-sm-2 col-sm-2 control-label">상세내역</label>
                  <div class="col-lg-10">
                  	<select name="bMoDetail" class="form-control">
					  <option value="">::: 비고 :::</option>
					  <option value="입찰예치금입금">입찰예치금입금</option>
					  <option value="거래대금입금">거래대금입금</option>
					</select>
                  </div>
                 </div>
				 <div class="form-group" style="display: none;" id="bMoDetail2">
                  <label class="col-sm-2 col-sm-2 control-label">상세내역</label>
                  <div class="col-lg-10">
                  	<select name="bMoDetail"  class="form-control">
					  <option value="">::: 비고 :::</option>
					  <option value="거래대금출금">거래대금출금</option>
					  <option value="입찰예치금환불">입찰예치금환불</option>
					</select>
                  </div>
                 </div>
				 <div class="form-group">
                  <label class="col-sm-2 col-sm-2 control-label">금액</label>
                  <div class="col-lg-10">
					<input type="text" class="form-control" name="bMoAmount" value="" placeholder="금액" onKeyup="this.value=this.value.replace(/[^0-9]/g,'');"/>
                  </div>
                 </div>
				 <div class="form-group" style="display: none;">
                  <label class="col-sm-2 col-sm-2 control-label">관련테이블코드</label>
                  <div class="col-lg-10">
					<input type="text" class="form-control" name="relatedCode" value="" />
                  </div>
                 </div>
				 <div class="form-group" style="display: none;">
                  <label class="col-sm-2 col-sm-2 control-label">관련테이블</label>
                  <div class="col-lg-10">
					<input type="text" class="form-control" name="relatedTable" value="" />
                  </div>
                 </div>
				 <div class="form-group" style="display: none;">
                  <label class="col-sm-2 col-sm-2 control-label">관리자 총액</label>
                  <div class="col-lg-10">
					<input type="text" class="form-control" name="bMoTotalmoney" value="" />
                  </div>
                 </div>
				 <div class="form-group">
                  <label class="col-sm-2 col-sm-2 control-label">입출금 시간</label>
                  <div class="col-lg-10">
					<input type="text" class="form-control" name="bMoDate" value="" placeholder="입출금 시간"/>
                  </div>
                 </div>
			</div>
		</div>
		<div class="form-group text-center">
			<button type="button" class="btn btn-info" onclick="insertFinish()">등록</button>
			<button type="button" class="btn btn-danger" onclick="insertCancle()">취소</button>
		</div>
	</form>
	
	<script type="text/javascript">
		var mId = $('[name="mId"]');
		var bMoDetail = $('[name="bMoDetail"]');
		var bMoAmount = $('[name="bMoAmount"]');
		var bMoType = $('[name="bMoType"]');
		
		bMoType.click(function(){
			if(bMoType.val() == "입금"){
				$('#bMoDetail1').css('display', 'block');
				$('#bMoDetail2').css('display', 'none');
			}else if(bMoType.val() == "출금"){
				$('#bMoDetail1').css('display', 'none');
				$('#bMoDetail2').css('display', 'block');
			}
		});
		
		function insertFinish(){
			var result = confirm('등록하시겠습니까?');
			if(result){
				console.log('등록완료');
				var request = $.ajax({
					url: "/bidMoneyInsertSend",
					method: "post",
					data: {  mId : mId.val()
							,bMoDetail : bMoDetail.val()
							,bMoAmount : bMoAmount.val()
							,bMoType : bMoType.val()	  }
				});
				
				request.done(function(data){
					opener.document.location.href="/profit/balance";
					window.close();
				});
				
				request.fail(function( jqXHR, textStatus){
					alert( "Request failed: " + textStatus);
				});
			}else{
				console.log('등록실패');
			}
		}
		
		function insertCancle(){
			window.close();
		}
		
	</script>
	
</body>	
</body>
</html>