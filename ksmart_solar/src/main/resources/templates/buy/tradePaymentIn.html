<!DOCTYPE html>
<html xmlns:th="http://www.tyhmeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="@{layout/default}">

	<th:block layout:fragment="customTitle">
				<title>대금납부</title>
	</th:block>
	<th:block layout:fragment="Contents">
		<div id="container-header-title"><strong>발전소 리스트</strong></div>
		<div id="container-header-path">
			<a href="/" style="text-decoration: none;">메인화면 </a>>
			<a href="/plant/plantList" style="text-decoration: none;"> 내 발전소 관리 </a>>
			<a href="/plant/plantList" style="text-decoration: none;"> 발전소 리스트 </a>
		</div>
		<div id="container-header-space"></div>
		<div class="chat-room mt">
          <aside class="mid-side container">
            <div class="chat-room-head">
              <h3>대금납부</h3>
            </div>
            <form class="cmxform form-horizontal style-form" id="plantSellForm" method="post" th:action="@{/notice/bidRequestResult}" enctype="multipart/form-data">
	            <div class="group-rom">
	              <div class="first-part odd">공고 제목</div>
	              <div class="second-part" >짱좋은 부품 팝니다</div>
	            </div>
	            <div class="group-rom">
	              <div class="first-part odd">날찰금액</div>
	              <div class="second-part">
	              	<input type="text" name="bPrice" placeholder="0">
	              </div>
	            </div>
	            <div class="group-rom">
	              <div class="first-part odd">예치금</div>
	              <div class="second-part" id="bDeposit">0
	              	<input type="hidden" name="bDeposit">
	              </div>
	            </div>
	            <div class="group-rom">
	              <div class="first-part odd">납부할 금액</div>
	              <div class="second-part" id="bDeposit">0
	              	<input type="hidden" name="bDeposit">
	              </div>
	            </div>
	            <div class="group-rom">
	              <div class="first-part odd">입금 은행</div>
	              <div class="second-part" >
	              	<select>
	              		<option>:::::은행선택:::::</option>
	              		<option>국민</option>
	              	</select>
	              </div>
	            </div>
	            <div class="group-rom">
	              <div class="first-part odd">관리자계좌번호</div>
	              <div class="second-part">해당 은행의 계좌번호</div>
	            </div>
	            <div class="group-rom">
	              <div class="first-part odd">입금자 성명</div>
	              <div class="second-part" ><input type="text"></div>
	            </div>
				<div class="group-rom">
					<div class="first-part odd">파일 첨부</div>
					<div class="second-part">
						<input type="file" id="files" class="default" name="files" multiple="multiple">
					</div>
				</div>
	            <div  class="pull-right" style="margin: 0px 10px;">
	            	<button class="btn btn-primary" type="submit">신청</button>
	          	</div>
          	</form>
           </aside>
        </div>
	</th:block>
	<th:block layout:fragment="customScript">
		
		<script type="text/javascript">
			$(function(){
				//입찰금액
				var bPrice = $('[name="bPrice"]');
				//예치금
				var bDeposit = $('[name="bDeposit"]');
				//보여지는 예치금
				var bDepositText = $('#bDeposit');
				//예치금율
				var sDepositRate = 0;			
				//예치금율 가져오는 비동기호출
				$.ajax({
					  url: '/sDepositRateCheck', 
					  method: 'POST',
					  success: function(data){
						  if(data != null){
							  sDepositRate = data;
						  }
					  },
					  error : function(xhr,status,error){
						  console.log("xhr: " + xhr);
						  console.log("status: " + status);
						  console.log("error: " + error);
					  }
				});
				//관리자 계좌 가져오기
				$.ajax({
					  url: '/bankCheck', 
					  method: 'POST',
					  success: function(data){
						  if(data != null){
						  }
					  },
					  error : function(xhr,status,error){
						  console.log("xhr: " + xhr);
						  console.log("status: " + status);
						  console.log("error: " + error);
					  }
				});
				//숫자에 콤마찍는 플러그인
				$.fn.transPrice = function(){
					var price = $(this).val().toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
					$(this).val(price);
				}
				//숫자만 입력하게 하는 플러그인
				$.fn.onlyNumber = function(){
					$(this).val($(this).val().replace(/[^0-9]/g,''));
				}
				//입찰금액을 입력할 때 
				bPrice.keyup(function(){
					$(this).onlyNumber();
					var num = $(this).val();
					bDeposit.val(num/100*sDepositRate);
					$(this).transPrice();
					bDeposit.transPrice();
					bDepositText.text(bDeposit.val());
				});
				
			});
		</script>
	</th:block>
</html>