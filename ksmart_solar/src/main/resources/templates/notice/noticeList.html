<!DOCTYPE html>
<html xmlns:th="http://www.tyhmeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="layout/default">

	<th:block layout:fragment="customTitle">
				<title>진행중인 공고 리스트</title>
	</th:block>
	<th:block layout:fragment="Contents">
		<div id="container-header-title"><strong>진행중인 공고 리스트</strong></div>
		<div id="container-header-path">
			<a href="/" style="text-decoration: none;"> 메인화면 </a>>
			<a href="#" style="text-decoration: none;">공고리스트 </a>>
			<a href="/notice/noticeList" style="text-decoration: none;"> 진행중인 공고 리스트 </a>
			<a href="/plant/plantList" style="text-decoration: none;"> 발전소 리스트 </a>
		</div>
		<div id="container-header-space"></div>
		<div class="row mt">
          <div class="col-md-12 container">
            <div class="content-panel" style="padding: 30px;">
                <h4><i class="fa fa-angle-right"></i> 진행중인 부품 공고</h4>
                <hr>
                <div style="text-align : right; margin-bottom: 10px;">
	              <form th:action="@{/notice/noticeList}">
	            	<select name="searchKeyCp">
	            		<option >카테고리</option>
	            		<option value="bCpTitle">공고명</option>
	            		<option value="mId">판매자</option>
	            	</select>
	            	<input type="text" placeholder="검색어" name="searchValueCp" th:value="${searchValueCp}">
	            	<input type="hidden" name="searchKeyPl" th:value="${searchKeyPl}">
		            <input type="hidden" name="searchValuePl" th:value="${searchValuePl}">
	            	<input type="submit" value = "검색" class="btn btn-default btn-sm">
	               </form>
               </div>
              <table class="table table-striped table-advance table-hover">
	                <thead>
	                  <tr>
	                    <th class="col-md-1">번호</th>
	                    <th class="col-md-5"><i class="fa fa-bullhorn"></i> 공고 제목</th>
	                    <th class="col-md-2"><i class="fa fa-question-circle"></i>판매자</th>
	                    <th class="col-md-2"><i class="fa fa-bookmark"></i>입찰 시작일 </th>
	                    <th class="col-md-2"><i class="fa fa-bookmark"></i>입찰 마감일 </th>
	                  </tr>
	                </thead>
	                <tbody>
	                	<th:block th:if="${bidComponentList != null}" th:each="l:${bidComponentList}">
			                  <tr>
			                    <td th:text="${l.num}"></td>
			                    <td style="text-align: left;">
			                    	<form th:action="@{/notice/announcement}" method="post">
				                      	<a class="announceTitle">[[${l.bCpTitle}]]</a>
				                      	<input type="hidden" name="announceCode" th:value="${l.bCpCode}">
				                      	<input type="hidden" name="announceType" value="부품">
			                    	</form>
			                    </td>
			                    <td th:text="${l.mId}"></td>
			                    <td th:text="${l.bCpDateBidding1}"></td>
			                    <td th:text="${l.bCpDateBidding2}"></td>
			                  </tr>
	                	</th:block>
	                	<th:block th:if="${bidComponentList==null || bidComponentList.size()==0}">
			                  <tr>
			                    <td colspan="5" style="text-align: center;">진행중인 공고가 없습니다.</td>		                 
			                  </tr>
	                	</th:block>
	                </tbody>
	                <tfoot>
	                   <tr>
	                   	<td colspan ="6" style="text-align:center;">
		                 	<th:block layout:fragment="paging">
	                  			<nav th:replace="fragments/pagination2 :: pagination"></nav>
	                  		</th:block>
	                  	</td>
	                  </tr>
	                </tfoot>
              </table>
            </div>
          </div>
        </div>
        
		<div class="row mt">
          <div class="col-md-12 container">
            <div class="content-panel" style="padding: 30px;">
                <h4><i class="fa fa-angle-right"></i> 진행중인 발전소 공고</h4>
                <hr>
                <div style="text-align : right; margin-bottom: 10px;">
		              <form th:action="@{/notice/noticeList}">
		            	<select name="searchKeyPl">
		            		<option >카테고리</option>
		            		<option value="bPlTitle">공고명</option>
		            		<option value="mId">판매자</option>
		            	</select>
		            	<input type="text" placeholder="검색어" name="searchValuePl" th:value="${searchValuePl}">
		            	<input type="hidden" name="searchKeyCp" th:value="${searchKeyCp}">
		            	<input type="hidden" name="searchValueCp" th:value="${searchValueCp}">
		            	<input type="submit" value = "검색" class="btn btn-default btn-sm">
		               </form>
	             </div>
              <table class="table table-striped table-advance table-hover">
                <thead>
                <tr>
                    <th class="col-md-1">번호</th>
                    <th class="col-md-5"><i class="fa fa-bullhorn"></i> 공고 제목</th>
                    <th class="col-md-2"><i class="fa fa-question-circle"></i>판매자</th>
                    <th class="col-md-2"><i class="fa fa-bookmark"></i>입찰 시작일 </th>
                    <th class="col-md-2"><i class="fa fa-bookmark"></i>입찰 마감일 </th>
                  </tr>
                </thead>
                <tbody>
                	<th:block th:if="${bidPlantList != null}" th:each="l:${bidPlantList}">
		                  <tr>
		                  	<td th:text="${l.num}"></td>
		                    <td style="text-align: left;">
		                    	<form th:action="@{/notice/announcement}" method="post">
			                      	<a class="announceTitle">[[${l.bPlTitle}]]</a>
			                      	<input type="hidden" name="announceCode" th:value="${l.bPlCode}">
			                      	<input type="hidden" name="announceType" value="발전소">
		                    	</form>
		                    </td>
		                    <td th:text="${l.mId}"></td>
		                    <td th:text="${l.bPlDateBidding1}"></td>
		                    <td th:text="${l.bPlDateBidding2}"></td>
		                  </tr>
                	</th:block>
                	<th:block th:if="${bidPlantList==null || bidPlantList.size()==0}">
		                  <tr>
		                    <td colspan="5" style="text-align: center;">진행중인 공고가 없습니다.</td>		                 
		                  </tr>
                	</th:block>
                </tbody>
                <tfoot>
                  <tr>
                  	<td colspan ="6" style="text-align:center;">
                  		<th:block layout:fragment="paging">
                  			<nav th:replace="fragments/pagination :: pagination"></nav>
                  		</th:block>
                  	</td>
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>
        </div>
	</th:block>
	<th:block layout:fragment="customScript">
		<script type="text/javascript">
			var notice = $('#notice');
			notice.addClass('active');
			notice.parent().find('.sub').css('display','block');
			notice.parent().find('.sub').children().eq(0).addClass('active');
			
			
			$('.announceTitle').click(function(){
				$(this).parent().submit();
			});
		
		</script>
		<script th:inline="javascript">
			/*<![CDATA[*/
			var searchKeyCp = /*[[ ${searchKeyCp} ]]*/;
			var searchValueCp = /*[[ ${searchValueCp} ]]*/;
			var searchKeyPl = /*[[ ${searchKeyPl} ]]*/;
			var searchValuePl = /*[[ ${searchValuePl} ]]*/;
			var selectCp = $('select[name="searchKeyCp"]');
			var selectPl = $('select[name="searchKeyPl"]');
			selectCp.children().each(function(){
				if($(this).val()==searchKeyCp){
					$(this).prop('selected',true);
				}
			})
			selectPl.children().each(function(){
				if($(this).val()==searchKeyPl){
					$(this).prop('selected',true);
				}
			})
			console.log(searchKeyCp)
			function movePage(uri, queryString) {
				location.href = uri + queryString + '&searchKeyCp='+ searchKeyCp+ '&searchValueCp=' + searchValueCp + '&searchKeyPl='+ searchKeyPl+ '&searchValuePl=' + searchValuePl;
			}
			
			function movePage2(uri, queryString) {
				location.href = uri + queryString + '&searchKeyCp='+ searchKeyCp+ '&searchValueCp=' + searchValueCp + '&searchKeyPl='+ searchKeyPl+ '&searchValuePl=' + searchValuePl;
			}

			/*]]>*/
		</script>
	</th:block>
</html>