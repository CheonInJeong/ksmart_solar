<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Config 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cafe24.kangk0269.dao.PickMapper">
	<resultMap type="PickDTO" id="PickDTOMap">
		<result property="pIdx"					column="p_idx"/>
		<result property="pCode"				column="p_code"/>
		<result property="mId"					column="m_id"/>
		<result property="pRegDate"				column="p_reg_date"/>
		<association property="bidPlantDTO" javaType="BidPlantDTO">
			<id		property="bPlCode"				column="b_pl_code"/>
			<result property="bPlTitle"				column="b_pl_title"/>
			<result property="bPlPrice"				column="b_pl_price"/>
			<result property="bPlDateBidding2"		column="b_pl_date_bidding2"/>
		</association>
	</resultMap>
	
	
	<!-- 관심목록 등록  -->
	<insert id="addWishlist" parameterType="String">
		INSERT INTO tb_pick
			(b_gen_regoods_code
			, m_id
			, p_reg_date)
		VALUES
			 ( #{announcedCode}
			 , #{login_id}
			 , NOW())	
	</insert>
	
	<!-- 관심목록 삭제 -->
	<delete id="removeWishlist" parameterType="int">
		DELETE 
		FROM
			 tb_pick
		WHERE
			p_idx = #{pIdx}
	</delete>
	
	<!-- 관심목록 조회  -->
	<select id="getWishList" parameterType="String" resultMap="PickDTOMap">
		SELECT 
			  p.p_idx
			, p.p_code
			, p.m_id
			, bp.b_pl_price
			, bp.b_pl_title
			, bp.b_pl_date_bidding2
		FROM 
			tb_pick AS p
		INNER JOIN
			tb_bid_plant AS bp
		ON 
			p.p_code = bp.b_pl_code
		WHERE
			p.m_id = #{login_id}
	</select>

</mapper>